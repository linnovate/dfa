(this["webpackJsonpcreate-daml-app"]=this["webpackJsonpcreate-daml-app"]||[]).push([[0],{294:function(e,t,n){},302:function(e,t){},304:function(e,t){},314:function(e,t){},316:function(e,t){},343:function(e,t){},345:function(e,t){},346:function(e,t){},351:function(e,t){},353:function(e,t){},359:function(e,t){},361:function(e,t){},380:function(e,t){},392:function(e,t){},395:function(e,t){},401:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(402))},402:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(91),c=n(141),a=(n(82),n(403));t.Follow={decoder:c.lazyMemo((function(){return r.object({userToFollow:c.Party.decoder})})),encode:function(e){return{userToFollow:c.Party.encode(e.userToFollow)}}},t.User={templateId:"95ecb0f837f28c9115dbcae3c4f2d50c4687725843a94008e75bc3b2db796c7a:User:User",keyDecoder:c.lazyMemo((function(){return c.lazyMemo((function(){return c.Party.decoder}))})),keyEncode:function(e){return c.Party.encode(e)},decoder:c.lazyMemo((function(){return r.object({username:c.Party.decoder,following:c.List(c.Party).decoder})})),encode:function(e){return{username:c.Party.encode(e.username),following:c.List(c.Party).encode(e.following)}},Archive:{template:function(){return t.User},choiceName:"Archive",argumentDecoder:c.lazyMemo((function(){return a.DA.Internal.Template.Archive.decoder})),argumentEncode:function(e){return a.DA.Internal.Template.Archive.encode(e)},resultDecoder:c.lazyMemo((function(){return c.Unit.decoder})),resultEncode:function(e){return c.Unit.encode(e)}},Follow:{template:function(){return t.User},choiceName:"Follow",argumentDecoder:c.lazyMemo((function(){return t.Follow.decoder})),argumentEncode:function(e){return t.Follow.encode(e)},resultDecoder:c.lazyMemo((function(){return c.ContractId(t.User).decoder})),resultEncode:function(e){return c.ContractId(t.User).encode(e)}}},c.registerTemplate(t.User)},403:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(404);t.DA=r,t.packageId="d14e08374fc7197d6a0de468c968ae8ba3aadbf9315476fd39071831f5923662"},404:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(405);t.Internal=r},405:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(406);t.Template=r},406:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(407))},407:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(91),c=n(141);n(82);t.Archive={decoder:c.lazyMemo((function(){return r.object({})})),encode:function(e){return{}}}},541:function(e,t,n){"use strict";n.r(t);var r,c,a=n(0),o=n.n(a),s=n(52),i=n.n(s),l=(n(293),n(294),n(55)),u=n(31),d=n.n(u),j=n(53),f=n(556),b=n(557),m=n(278),p=n(551),h=n(558),O=n(554),x=n(261);!function(e){e[e.DEV=0]="DEV",e[e.PROD_DABL=1]="PROD_DABL",e[e.PROD_OTHER=2]="PROD_OTHER"}(c||(c={}));var g=window.location.hostname.endsWith(".projectdabl.com")?c.PROD_DABL:c.PROD_OTHER,v=g===c.PROD_DABL?window.location.hostname.split(".")[0]:null!==(r="create-daml-app-sandbox")?r:"create-daml-app-sandbox",w=g===c.PROD_DABL?"https://api.projectdabl.com/data/".concat(v,"/"):void 0;var y=function(e){return{party:e,token:function(e){var t={"https://daml.com/ledger-api":{ledgerId:v,applicationId:"create-daml-app",actAs:[e]}};return Object(x.encode)(t,"secret","HS256")}(e),ledgerId:v}},k=n(82),P=n.n(k),D=n(56),U=n(6),_=function(e){var t=e.onLogin,n=o.a.useState(""),r=Object(l.a)(n,2),s=r[0],i=r[1],u=Object(a.useCallback)(function(){var e=Object(j.a)(d.a.mark((function e(n){var r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new P.a({token:n.token,httpBaseUrl:w}),e.next=4,r.fetchByKey(D.User.User,n.party);case 4:if(null!==e.sent){e.next=10;break}return c={username:n.party,following:[]},e.next=9,r.create(D.User.User,c);case 9:e.sent;case 10:t(n),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),alert("Unknown error:\n".concat(e.t0));case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),[t]),x=function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=y(s),e.next=4,u(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){var e=new URL(window.location.toString()),t=e.searchParams.get("token");if(null!==t){var n=e.searchParams.get("party");if(null===n)throw Error("When 'token' is passed via URL, 'party' must be passed too.");e.search="",window.history.replaceState(window.history.state,"",e.toString()),u({token:t,party:n,ledgerId:v})}}),[u]),Object(U.jsx)(f.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"middle",children:Object(U.jsxs)(f.a.Column,{style:{maxWidth:450},children:[Object(U.jsx)(b.a,{as:"h1",textAlign:"center",size:"huge",style:{color:"#223668"},children:Object(U.jsxs)(b.a.Content,{children:["Create",Object(U.jsx)(m.a,{as:"a",href:"https://www.daml.com/",target:"_blank",src:"/daml.svg",alt:"Daml Logo",spaced:!0,size:"small",verticalAlign:"bottom"}),"App"]})}),Object(U.jsx)(p.a,{size:"large",className:"test-select-login-screen",children:Object(U.jsx)(h.a,{children:g!==c.PROD_DABL?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(p.a.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"Username",value:s,className:"test-select-username-field",onChange:function(e){return i(e.currentTarget.value)}}),Object(U.jsx)(O.a,{primary:!0,fluid:!0,className:"test-select-login-button",onClick:x,children:"Log in"})]}):Object(U.jsx)(O.a,{primary:!0,fluid:!0,onClick:function(){window.location.assign("https://login.projectdabl.com/auth/login?ledgerId=".concat(v))},children:"Log in with DABL"})})})]})})},I=n(555),C=n(549),A=n(44),L=n(550),M=n(40),F=n.n(M),R=n(84),z=n(553),N=function(e){var t=e.users,n=e.onFollow;return Object(U.jsx)(z.a,{divided:!0,relaxed:!0,children:Object(R.a)(t).sort((function(e,t){return e.username.localeCompare(t.username)})).map((function(e){return Object(U.jsxs)(z.a.Item,{children:[Object(U.jsx)(z.a.Icon,{name:"user"}),Object(U.jsxs)(z.a.Content,{children:[Object(U.jsx)(z.a.Content,{floated:"right",children:Object(U.jsx)(A.a,{name:"add user",link:!0,className:"test-select-add-user-icon",onClick:function(){return n(e.username)}})}),Object(U.jsx)(z.a.Header,{className:"test-select-user-in-network",children:e.username})]}),Object(U.jsx)(z.a.List,{children:Object(R.a)(e.following).sort((function(e,t){return e.localeCompare(t)})).map((function(e){return Object(U.jsxs)(z.a.Item,{children:[Object(U.jsx)(z.a.Content,{floated:"right",children:Object(U.jsx)(A.a,{name:"add user",link:!0,className:"test-select-add-user-following-icon",onClick:function(){return n(e)}})}),Object(U.jsx)(z.a.Icon,{name:"user outline"}),Object(U.jsx)(z.a.Content,{children:Object(U.jsx)(z.a.Header,{children:e})})]},e)}))})]},e.username)}))})},T=function(e){var t=e.parties,n=e.onAddParty,r=o.a.useState(""),c=Object(l.a)(r,2),a=c[0],s=c[1],i=o.a.useState(!1),u=Object(l.a)(i,2),f=u[0],b=u[1],m=function(){var e=Object(j.a)(d.a.mark((function e(t){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),b(!0),e.next=4,n(a);case 4:r=e.sent,b(!1),r&&s("");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(U.jsxs)(z.a,{relaxed:!0,children:[Object(R.a)(t).sort((function(e,t){return e.localeCompare(t)})).map((function(e){return Object(U.jsxs)(z.a.Item,{children:[Object(U.jsx)(z.a.Icon,{name:"user outline"}),Object(U.jsx)(z.a.Content,{children:Object(U.jsx)(z.a.Header,{className:"test-select-following",children:e})})]},e)})),Object(U.jsx)("br",{}),Object(U.jsxs)(p.a,{onSubmit:m,children:[Object(U.jsx)(p.a.Input,{fluid:!0,readOnly:f,loading:f,className:"test-select-follow-input",placeholder:"Username to follow",value:a,onChange:function(e){return s(e.currentTarget.value)}}),Object(U.jsx)(O.a,{type:"submit",className:"test-select-follow-button",children:"Follow"})]})]})},B=function(){var e,t,n,r=Object(M.useParty)(),c=null===(e=Object(M.useStreamFetchByKeys)(D.User.User,(function(){return[r]}),[r]).contracts[0])||void 0===e?void 0:e.payload,o=Object(M.useStreamQueries)(D.User.User).contracts,s=Object(a.useMemo)((function(){return o.map((function(e){return e.payload})).filter((function(e){return e.username!==r})).sort((function(e,t){return e.username.localeCompare(t.username)}))}),[o,r]),i=Object(M.useLedger)(),l=function(){var e=Object(j.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.exerciseByKey(D.User.User.Follow,r,{userToFollow:t});case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),alert("Unknown error:\n".concat(e.t0)),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(U.jsx)(C.a,{children:Object(U.jsx)(f.a,{centered:!0,columns:2,children:Object(U.jsx)(f.a.Row,{stretched:!0,children:Object(U.jsxs)(f.a.Column,{children:[Object(U.jsx)(b.a,{as:"h1",size:"huge",color:"blue",textAlign:"center",style:{padding:"1ex 0em 0ex 0em"},children:c?"Welcome, ".concat(c.username,"!"):"Loading..."}),Object(U.jsxs)(h.a,{children:[Object(U.jsxs)(b.a,{as:"h2",children:[Object(U.jsx)(A.a,{name:"user"}),Object(U.jsxs)(b.a.Content,{children:[null!==(t=null===c||void 0===c?void 0:c.username)&&void 0!==t?t:"Loading...",Object(U.jsx)(b.a.Subheader,{children:"Users I'm following"})]})]}),Object(U.jsx)(L.a,{}),Object(U.jsx)(T,{parties:null!==(n=null===c||void 0===c?void 0:c.following)&&void 0!==n?n:[],onAddParty:l})]}),Object(U.jsxs)(h.a,{children:[Object(U.jsxs)(b.a,{as:"h2",children:[Object(U.jsx)(A.a,{name:"globe"}),Object(U.jsxs)(b.a.Content,{children:["The Network",Object(U.jsx)(b.a.Subheader,{children:"My followers and users they are following"})]})]}),Object(U.jsx)(L.a,{}),Object(U.jsx)(N,{users:s,onFollow:l})]})]})})})})},E=function(e){var t=e.onLogout;return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)(I.a,{icon:!0,borderless:!0,children:[Object(U.jsx)(I.a.Item,{children:Object(U.jsx)(m.a,{as:"a",href:"https://www.daml.com/",target:"_blank",src:"/daml.svg",alt:"Daml Logo",size:"mini"})}),Object(U.jsxs)(I.a.Menu,{position:"right",className:"test-select-main-menu",children:[Object(U.jsxs)(I.a.Item,{position:"right",children:["You are logged in as ",Object(M.useParty)(),"."]}),Object(U.jsx)(I.a.Item,{position:"right",active:!1,className:"test-select-log-out",onClick:t,icon:"log out"})]})]}),Object(U.jsx)(B,{})]})},S=function(){var e=o.a.useState(),t=Object(l.a)(e,2),n=t[0],r=t[1];return n?Object(U.jsx)(F.a,{token:n.token,party:n.party,httpBaseUrl:w,children:Object(U.jsx)(E,{onLogout:function(){return r(void 0)}})}):Object(U.jsx)(_,{onLogin:r})};i.a.render(Object(U.jsx)(S,{}),document.getElementById("root"))},56:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(401);t.User=r,t.packageId="95ecb0f837f28c9115dbcae3c4f2d50c4687725843a94008e75bc3b2db796c7a"}},[[541,1,2]]]);
//# sourceMappingURL=main.079c0e0d.chunk.js.map