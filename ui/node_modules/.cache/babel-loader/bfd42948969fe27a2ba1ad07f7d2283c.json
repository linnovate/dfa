{"ast":null,"code":"var _jsxFileName = \"/Users/liorkesos/projects/daml/create-daml-app/ui/src/components/MainView.tsx\",\n    _s = $RefreshSig$();\n\n// Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useMemo } from 'react';\nimport { Container, Grid, Header, Icon, Segment, Divider } from 'semantic-ui-react';\nimport { User } from '@daml.js/create-daml-app';\nimport { useParty, useLedger, useStreamFetchByKeys, useStreamQueries } from '@daml/react';\nimport UserList from './UserList';\nimport PartyListEdit from './PartyListEdit'; // USERS_BEGIN\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MainView = () => {\n  _s();\n\n  var _myUserResult$contrac, _myUser$username, _myUser$following;\n\n  const username = useParty();\n  const myUserResult = useStreamFetchByKeys(User.User, () => [username], [username]);\n  const myUser = (_myUserResult$contrac = myUserResult.contracts[0]) === null || _myUserResult$contrac === void 0 ? void 0 : _myUserResult$contrac.payload;\n  const allUsers = useStreamQueries(User.User).contracts; // USERS_END\n  // Sorted list of users that are following the current user\n\n  const followers = useMemo(() => allUsers.map(user => user.payload).filter(user => user.username !== username).sort((x, y) => x.username.localeCompare(y.username)), [allUsers, username]); // FOLLOW_BEGIN\n\n  const ledger = useLedger();\n\n  const follow = async userToFollow => {\n    try {\n      await ledger.exerciseByKey(User.User.Follow, username, {\n        userToFollow\n      });\n      return true;\n    } catch (error) {\n      alert(`Unknown error:\\n${error}`);\n      return false;\n    }\n  }; // FOLLOW_END\n\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: /*#__PURE__*/_jsxDEV(Grid, {\n      centered: true,\n      columns: 2,\n      children: /*#__PURE__*/_jsxDEV(Grid.Row, {\n        stretched: true,\n        children: /*#__PURE__*/_jsxDEV(Grid.Column, {\n          children: [/*#__PURE__*/_jsxDEV(Header, {\n            as: \"h1\",\n            size: \"huge\",\n            color: \"blue\",\n            textAlign: \"center\",\n            style: {\n              padding: '1ex 0em 0ex 0em'\n            },\n            children: myUser ? `Welcome, ${myUser.username}!` : 'Loading...'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 47,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Segment, {\n            children: [/*#__PURE__*/_jsxDEV(Header, {\n              as: \"h2\",\n              children: [/*#__PURE__*/_jsxDEV(Icon, {\n                name: \"user\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 53,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Header.Content, {\n                children: [(_myUser$username = myUser === null || myUser === void 0 ? void 0 : myUser.username) !== null && _myUser$username !== void 0 ? _myUser$username : 'Loading...', /*#__PURE__*/_jsxDEV(Header.Subheader, {\n                  children: \"Users I'm following\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 56,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 54,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 52,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 59,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(PartyListEdit, {\n              parties: (_myUser$following = myUser === null || myUser === void 0 ? void 0 : myUser.following) !== null && _myUser$following !== void 0 ? _myUser$following : [],\n              onAddParty: follow\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 60,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 51,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Segment, {\n            children: [/*#__PURE__*/_jsxDEV(Header, {\n              as: \"h2\",\n              children: [/*#__PURE__*/_jsxDEV(Icon, {\n                name: \"globe\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 67,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Header.Content, {\n                children: [\"The Network\", /*#__PURE__*/_jsxDEV(Header.Subheader, {\n                  children: \"My followers and users they are following\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 70,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 68,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 66,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 73,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(UserList, {\n              users: followers,\n              onFollow: follow\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 5\n  }, this);\n};\n\n_s(MainView, \"RneS22kmw6Za/v288qKxbPjJuwA=\", false, function () {\n  return [useParty, useStreamFetchByKeys, useStreamQueries, useLedger];\n});\n\n_c = MainView;\nexport default MainView;\n\nvar _c;\n\n$RefreshReg$(_c, \"MainView\");","map":{"version":3,"sources":["/Users/liorkesos/projects/daml/create-daml-app/ui/src/components/MainView.tsx"],"names":["React","useMemo","Container","Grid","Header","Icon","Segment","Divider","User","useParty","useLedger","useStreamFetchByKeys","useStreamQueries","UserList","PartyListEdit","MainView","username","myUserResult","myUser","contracts","payload","allUsers","followers","map","user","filter","sort","x","y","localeCompare","ledger","follow","userToFollow","exerciseByKey","Follow","error","alert","padding","following"],"mappings":"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","sourcesContent":["// Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport React, { useMemo } from 'react';\nimport { Container, Grid, Header, Icon, Segment, Divider } from 'semantic-ui-react';\nimport { Party } from '@daml/types';\nimport { User } from '@daml.js/create-daml-app';\nimport { useParty, useLedger, useStreamFetchByKeys, useStreamQueries } from '@daml/react';\nimport UserList from './UserList';\nimport PartyListEdit from './PartyListEdit';\n\n// USERS_BEGIN\nconst MainView: React.FC = () => {\n  const username = useParty();\n  const myUserResult = useStreamFetchByKeys(User.User, () => [username], [username]);\n  const myUser = myUserResult.contracts[0]?.payload;\n  const allUsers = useStreamQueries(User.User).contracts;\n// USERS_END\n\n  // Sorted list of users that are following the current user\n  const followers = useMemo(() =>\n    allUsers\n    .map(user => user.payload)\n    .filter(user => user.username !== username)\n    .sort((x, y) => x.username.localeCompare(y.username)),\n    [allUsers, username]);\n\n  // FOLLOW_BEGIN\n  const ledger = useLedger();\n\n  const follow = async (userToFollow: Party): Promise<boolean> => {\n    try {\n      await ledger.exerciseByKey(User.User.Follow, username, {userToFollow});\n      return true;\n    } catch (error) {\n      alert(`Unknown error:\\n${error}`);\n      return false;\n    }\n  }\n  // FOLLOW_END\n\n  return (\n    <Container>\n      <Grid centered columns={2}>\n        <Grid.Row stretched>\n          <Grid.Column>\n            <Header as='h1' size='huge' color='blue' textAlign='center' style={{padding: '1ex 0em 0ex 0em'}}>\n                {myUser ? `Welcome, ${myUser.username}!` : 'Loading...'}\n            </Header>\n\n            <Segment>\n              <Header as='h2'>\n                <Icon name='user' />\n                <Header.Content>\n                  {myUser?.username ?? 'Loading...'}\n                  <Header.Subheader>Users I'm following</Header.Subheader>\n                </Header.Content>\n              </Header>\n              <Divider />\n              <PartyListEdit\n                parties={myUser?.following ?? []}\n                onAddParty={follow}\n              />\n            </Segment>\n            <Segment>\n              <Header as='h2'>\n                <Icon name='globe' />\n                <Header.Content>\n                  The Network\n                  <Header.Subheader>My followers and users they are following</Header.Subheader>\n                </Header.Content>\n              </Header>\n              <Divider />\n              {/* USERLIST_BEGIN */}\n              <UserList\n                users={followers}\n                onFollow={follow}\n              />\n              {/* USERLIST_END */}\n            </Segment>\n          </Grid.Column>\n        </Grid.Row>\n      </Grid>\n    </Container>\n  );\n}\n\nexport default MainView;\n"]},"metadata":{},"sourceType":"module"}